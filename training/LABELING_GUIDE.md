# Руководство по разметке карт для YOLO

## Установка LabelImg

```bash
# Windows / macOS / Linux
pip install labelImg

# Запуск
labelImg
```

## Настройка LabelImg

### 1. Создайте файл классов

Создайте файл `classes.txt` со списком всех 52 карт:

```
2c
3c
4c
5c
6c
7c
8c
9c
Tc
Jc
Qc
Kc
Ac
2d
3d
4d
5d
6d
7d
8d
9d
Td
Jd
Qd
Kd
Ad
2h
3h
4h
5h
6h
7h
8h
9h
Th
Jh
Qh
Kh
Ah
2s
3s
4s
5s
6s
7s
8s
9s
Ts
Js
Qs
Ks
As
```

### 2. Настройка LabelImg

1. Откройте LabelImg
2. `View` → `Auto Save Mode` (включить)
3. `View` → Change Save Dir → выберите `card_dataset/labels/train`
4. Нажмите `Open Dir` → выберите `card_dataset/images/train`
5. Убедитесь что формат `YOLO` (кнопка слева показывает формат)

### 3. Процесс разметки

1. Используйте `W` для создания прямоугольника
2. Обведите карту точно по границам
3. Выберите класс карты из списка (например `As` для туза пик)
4. Нажмите `D` для следующего изображения
5. Нажмите `A` для предыдущего

### Горячие клавиши LabelImg

| Клавиша | Действие |
|---------|----------|
| W | Создать прямоугольник |
| D | Следующее изображение |
| A | Предыдущее изображение |
| Del | Удалить выделенный бокс |
| Ctrl+S | Сохранить |
| Ctrl+D | Дублировать бокс |

## Советы по разметке

### Что размечать

✅ **Размечайте:**
- Карты героя (hole cards)
- Карты на борде (community cards)
- Карты оппонентов (если видны при showdown)

❌ **НЕ размечайте:**
- Рубашки карт (card backs)
- Размытые или нечёткие карты
- Частично скрытые карты (если меньше 50% видно)

### Точность разметки

```
┌─────────────────┐
│  ┌───────────┐  │   ❌ Слишком много отступа
│  │    As     │  │
│  └───────────┘  │
└─────────────────┘

┌───────────┐
│    As     │         ✅ Точно по границам карты
└───────────┘
```

## Структура датасета

После разметки структура должна быть:

```
card_dataset/
├── images/
│   ├── train/
│   │   ├── screenshot_001.jpg
│   │   ├── screenshot_002.jpg
│   │   └── ...
│   └── val/
│       ├── screenshot_100.jpg
│       └── ...
└── labels/
    ├── train/
    │   ├── screenshot_001.txt
    │   ├── screenshot_002.txt
    │   └── ...
    └── val/
        ├── screenshot_100.txt
        └── ...
```

### Формат меток (YOLO)

Каждый `.txt` файл содержит строки:
```
class_id center_x center_y width height
```

Пример (`screenshot_001.txt`):
```
51 0.456 0.678 0.052 0.098
38 0.512 0.678 0.052 0.098
12 0.350 0.400 0.045 0.085
```

Все значения нормализованы от 0 до 1.

## Разделение на train/val

Рекомендуемое соотношение: 80% train, 20% val

```bash
# Скрипт для автоматического разделения
python split_dataset.py --input card_dataset/images/raw --ratio 0.8
```

## Проверка датасета

Перед обучением проверьте:

```bash
python train_cards.py --validate-only --dataset card_dataset
```

## Альтернатива: Roboflow

Если LabelImg кажется сложным, используйте [Roboflow](https://roboflow.com/):

1. Создайте бесплатный аккаунт
2. Загрузите изображения
3. Разметьте через веб-интерфейс
4. Экспортируйте в YOLO формат
5. Скачайте и распакуйте в `card_dataset/`

Roboflow также предлагает:
- Автоматическую аугментацию
- Командную работу
- Версионирование датасета
